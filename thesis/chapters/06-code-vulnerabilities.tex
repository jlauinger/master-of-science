%% -----------------------------------------------------------------------------

\chapter{Code vulnerabilities due to unsafe code}\label{ch:code-vulnerabilities}

This chapter provides an in-depth security analysis of unsafe code usage.


%% -----------------------------------------------------------------------------

\section{Cryptographic APIs}\label{sec:cryptographic-apis}

Show common designs of cryptographic APIs, especially those that are accessible from
within Go.


%% -----------------------------------------------------------------------------

\section{Vulnerability analysis}\label{sec:vulnerability-analysis}

Work out vulnerabilities that arise from the usage of unsafe code, both in the context
of cryptographic APIs and general APIs.

The following Github pull requests were submitted to notify the projects.

\begin{table}[h]
    \centering
    \caption{Github pull requests to fix vulnerable Go libraries}
    \label{tbl:pull-requests}
    \begin{tabular}{llll}
        \toprule
        {} & Project & PR-Name & Link \\
        \midrule
        1  & hanwen/go-fuse & batch forget: fix missing return to handle malformed input data & \href{https://www.github.com/hanwen/go-fuse/pull/363}{PR \#363} \\
        2  & buger/jsonparser & Fix possible memory confusion in unsafe slice cast & \href{https://www.github.com/buger/jsonparser/pull/204}{PR \#204} \\
        3  & elastic/go-structform & Fix possible memory confusion in unsafe slice cast & \href{https://github.com/elastic/go-structform/pull/21}{PR \#21} \\
        4  & go-fiber/utils & Fix possible memory confusion in unsafe slice cast & \href{https://github.com/gofiber/utils/pull/7}{PR \#7} \\
        5  & influxdata/influxdb & fix: possible memory confusion in unsafe slice cast & \href{https://github.com/influxdata/influxdb/pull/18307}{PR \#18307} \\
        6  & influxdata/influxdb1-client & fix: possible memory confusion in unsafe slice cast & \href{https://github.com/influxdata/influxdb1-client/pull/40}{PR \#40} \\
        7  & modern-go/reflect2 & Fix possible memory confusion in unsafe slice cast & \href{https://github.com/modern-go/reflect2/pull/13}{PR \#13} \\
        8  & savsgio/gotils & Fix possible memory confusion in unsafe slice cast & \href{https://github.com/savsgio/gotils/pull/2}{PR \#2} \\
        9  & valyala/fasttemplate & Fix possible memory confusion in unsafe slice cast & \href{https://github.com/valyala/fasttemplate/pull/21}{PR \#21} \\
        10 & weaveworks/ps & Fix possible memory confusion in unsafe slice cast & \href{https://github.com/weaveworks/ps/pull/3}{PR \#3} \\
        11 & yuin/goldmark & Fix possible memory confusion in unsafe slice cast & \href{https://github.com/yuin/goldmark/pull/134}{PR \#134} \\
        12 & yuin/gopher-lua & Fix possible memory confusion in unsafe slice cast & \href{https://github.com/yuin/gopher-lua/pull/287}{PR \#287} \\
        13 & gorgonia/tensor & Fix possible memory confusion in unsafe slice cast & \href{https://github.com/gorgonia/tensor/pull/68}{PR \#68} \\
        \bottomrule
    \end{tabular}
\end{table}

The following pull requests did exist already:

\begin{table}[h]
    \centering
    \caption{Github pull requests already existing}
    \label{tbl:pull-requests-existing}
    \begin{tabular}{llll}
        \toprule
        {} & Project & PR-Name & Link \\
        \midrule
        1  & mailru/easyjson & fix unsafe `unsafe` usage & \href{https://github.com/mailru/easyjson/pull/258}{PR \#258} \\
        \bottomrule
    \end{tabular}
\end{table}


%% -----------------------------------------------------------------------------

\section{Possible countermeasures}\label{sec:countermeasures}

Provide countermeasures against the identified vulnerabilities.
